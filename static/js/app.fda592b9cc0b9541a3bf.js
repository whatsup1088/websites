webpackJsonp([1],{"/sQn":function(t,e){},0:function(t,e){},"Dv/7":function(t,e){},NHnr:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("7+uW"),s={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]};var r=i("VU/8")({name:"App"},s,!1,function(t){i("Zhg0")},null,null).exports,o=i("/ocq"),a=i("c/Tr"),l=i.n(a),c={name:"Gift",props:{trigger:{type:Date,default:!1},config:{type:Object,required:!0}},data:function(){return{isRunning:!1,currentDeg:0,targetDeg:0,giftsDeg:[]}},computed:{displayType:function(){return this.config.run3D?"three-dimension":"flat"},rotate:function(){return 360/this.config.gifts.length},translateZ:function(){return this.config.height/2/Math.tan(this.rotate/2/180*Math.PI)}},watch:{config:{handler:function(){this.setConfig()},deep:!0},trigger:function(){this.autoTurn()},isRunning:function(){var t=this;this.isRunning&&setTimeout(function(){t.autoTurnStop()},this.config.duration+200)}},mounted:function(){this.setConfig(),this.logGiftsDeg()},destroyed:function(){},methods:{logGiftsDeg:function(){var t=this;this.config.gifts.forEach(function(e,i){t.giftsDeg[i]={from:0===i?0:t.giftsDeg[i-1].to,to:0===i?t.rotate:t.giftsDeg[i-1].to+t.rotate,name:e.name}})},setConfig:function(){this.$el.style.setProperty("--rotateY",this.config.rotateY+"deg"),this.$el.style.setProperty("--duration",this.config.duration+"ms"),this.$el.style.setProperty("--fontSize",this.config.fontSize+"px"),this.$el.style.setProperty("--height",this.config.height+"px"),this.$el.style.setProperty("--width",this.config.width+"px"),this.$el.style.setProperty("--currentDeg","-"+this.currentDeg+"deg")},autoTurn:function(){var t=360*Math.random()+1800;t-=t%this.rotate,this.targetDeg=t;var e=this.config.rollback?Math.random()*this.config.rollback+1:1;this.$el.style.setProperty("--targetDeg","-"+this.targetDeg+"deg"),this.$el.style.setProperty("--rollBackDeg",""+e),this.isRunning=!0},autoTurnStop:function(){this.currentDeg=this.targetDeg%360,this.$el.style.setProperty("--currentDeg","-"+this.currentDeg+"deg");var t=null,e=this.currentDeg+this.rotate/2;this.giftsDeg.forEach(function(i){e>=i.from&&e<=i.to&&(t=i.name)}),this.isRunning=!1,this.$emit("finished",t)}}},u={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:["gift-container",t.displayType,{autoTurn:t.isRunning}]},t._l(t.config.gifts,function(e,n){return i("div",{key:n,class:["gift",t.config.style],style:"transform: rotateX("+t.rotate*n+"deg) translateZ("+t.translateZ+"px)"},["text"===e.type?[t._v(t._s(e.name))]:t._e(),t._v(" "),"image"===e.type?[i("img",{attrs:{src:e.path,height:t.config.height}})]:t._e()],2)}))},staticRenderFns:[]};var h={name:"DemoSlotMachine",components:{Gift:i("VU/8")(c,u,!1,function(t){i("Dv/7")},null,null).exports},data:function(){return{run3D:!0,trigger:null,disabled:!1,configs:[{run3D:!1,rotateY:-25,duration:4e3,rollback:.3,fontSize:100,height:100,width:200,gifts:l()(new Array(10),function(t,e){return{type:"text",name:e}})},{run3D:!1,rotateY:-25,duration:5e3,rollback:.3,fontSize:100,height:100,width:200,gifts:l()(new Array(10),function(t,e){return{type:"text",name:e}})},{run3D:!1,rotateY:-25,duration:6e3,rollback:.3,fontSize:100,height:100,width:200,gifts:l()(new Array(10),function(t,e){return{type:"text",name:e}})}],openResultHistory:!1,result:[],resultHistory:[]}},methods:{turn:function(){this.disabled=!0,this.trigger=new Date},isFinished:function(t){var e=this.$el.querySelectorAll(".autoTurn");this.result.push(t),1===e.length&&(this.disabled=!1,this.resultHistory.push(this.result),this.result=[])},changeDisplayMode:function(t){this.configs.forEach(function(e){return e.run3D=t.target.checked})}}},g={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"DemoSlotMachine"},on:{click:function(e){if(e.target!==e.currentTarget)return null;t.openResultHistory=!1}}},[i("div",{class:["resultHistory",{openResultHistory:t.openResultHistory}]},t._l(t.resultHistory,function(e,n){return i("div",{key:n,staticClass:"result"},[t._v(t._s("Round"+(n+1)+": "+e))])})),t._v(" "),i("div",{staticClass:"container"},t._l(t.configs,function(e,n){return i("Gift",{key:n,attrs:{trigger:t.trigger,config:e},on:{finished:t.isFinished}})})),t._v(" "),i("div",{staticClass:"settings"},[i("button",{staticClass:"btn",attrs:{disabled:t.disabled},on:{click:t.turn}},[t._v("\n      START\n    ")]),t._v(" "),i("button",{staticClass:"btn",on:{click:function(e){t.openResultHistory=!0}}},[t._v("\n      Result History\n    ")]),t._v(" "),i("input",{staticClass:"displayType",attrs:{type:"checkbox",disabled:t.disabled},on:{change:t.changeDisplayMode}})])])},staticRenderFns:[]};var f=i("VU/8")(h,g,!1,function(t){i("/sQn")},"data-v-449d5df2",null).exports,d=i("fZjL"),p=i.n(d),v=i("gRE1"),y=i.n(v),m={name:"Gift",props:{trigger:{type:Date,default:!1},config:{type:Object,required:!0},leader:"",defaultOnShow:""},data:function(){return{isRunning:!1,currentDeg:0,targetDeg:0,giftsDeg:[]}},computed:{displayType:function(){return this.config.run3D?"three-dimension":"flat"},rotate:function(){return 360/this.config.gifts.length},translateZ:function(){return this.config.height/2/Math.tan(this.rotate/2/180*Math.PI)}},watch:{config:{handler:function(){this.setConfig()},deep:!0},trigger:function(){this.autoTurn()},isRunning:function(){var t=this;this.isRunning&&setTimeout(function(){t.autoTurnStop()},this.config.duration+200)}},mounted:function(){this.setConfig(),this.logGiftsDeg()},destroyed:function(){},methods:{logGiftsDeg:function(){var t=this;this.config.gifts.forEach(function(e,i){t.giftsDeg[i]={from:0===i?0:t.giftsDeg[i-1].to,to:0===i?t.rotate:t.giftsDeg[i-1].to+t.rotate,name:e.name,leader:e.leader}})},setConfig:function(){this.$el.style.setProperty("--rotateY",this.config.rotateY+"deg"),this.$el.style.setProperty("--duration",this.config.duration+"ms"),this.$el.style.setProperty("--fontSize",this.config.fontSize+"px"),this.$el.style.setProperty("--height",this.config.height+"px"),this.$el.style.setProperty("--width",this.config.width+"px"),this.$el.style.setProperty("--currentDeg","-"+this.currentDeg+"deg")},autoTurn:function(){var t=this.leader;console.log(t),console.log(this.giftsDeg);var e=this.giftsDeg.find(function(e){return e.leader===t});console.log(e.from);var i=e.from+5400;i-=i%this.rotate,this.targetDeg=i;var n=this.config.rollback?Math.random()*this.config.rollback+1:1;this.$el.style.setProperty("--targetDeg","-"+this.targetDeg+"deg"),this.$el.style.setProperty("--rollBackDeg",""+n),this.isRunning=!0},autoTurnStop:function(){this.currentDeg=this.targetDeg%360,this.$el.style.setProperty("--currentDeg","-"+this.currentDeg+"deg");var t=null,e=this.currentDeg+this.rotate/2;this.giftsDeg.forEach(function(i){e>=i.from&&e<=i.to&&(t=i.name)}),this.isRunning=!1,this.$emit("finished",t)}}},D={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:["gift-container",t.displayType,{autoTurn:t.isRunning}]},t._l(t.config.gifts,function(e,n){return i("div",{key:n,class:["gift",t.config.style],style:"transform: rotateX("+t.rotate*n+"deg) translateZ("+t.translateZ+"px)"},["text"===e.type&&t.defaultOnShow?[t._v("? ? ?")]:t._e(),t._v(" "),"text"!==e.type||t.defaultOnShow?t._e():[t._v(t._s(e.name))],t._v(" "),"image"===e.type?[i("img",{attrs:{src:e.path,height:t.config.height}})]:t._e()],2)}))},staticRenderFns:[]};var _={name:"SlotMachine",components:{Gift:i("VU/8")(m,D,!1,function(t){i("VjNl")},null,null).exports},data:function(){return{run3D:!1,trigger:null,active:!1,disabled:!1,leaders:{},leader:"",assistant:[],configs:[],openResultList:!1,resultList:[],result:[],currentLeader:"",leaderIndex:0,isClickNextLeader:!0,defaultOnShow:!0}},mounted:function(){this.fetchData()},methods:{fetchData:function(){console.log("Load Data");var t={};this.$http.get("https://sheets.googleapis.com/v4/spreadsheets/1-2OL_rGUPmvHLk1tXcwjlXo2Qkoq29ThKjsubdhUP3Q/values/table?key=AIzaSyBz-EwHl2quASbDzFAGteprh1oTC60o4dA").then(function(e){var i=e.body.values;i.shift(),i.forEach(function(e){t[e[1]]=e[0]}),this.init(t)})},init:function(t){console.log("Init Data"),console.log(t),this.leaders=y()(t),this.currentLeader=this.leaders[this.leaderIndex],this.configs=[{style:"gift-style",gifts:l()(p()(t),function(e,i){return{type:"text",name:e,leader:t[e]}}),duration:4e3,fontSize:150,height:200,width:600}]},nextLeader:function(){this.currentLeader=this.leaders[++this.leaderIndex],this.isClickNextLeader=!0,this.disabled=!1},turn:function(){var t=this;this.active=!0,this.defaultOnShow=!1,setTimeout(function(){t.active=!1},500),this.disabled=!0,this.isClickNextLeader=!1,this.trigger=new Date},isFinished:function(t){console.log("STOP"),this.result.leader=this.currentLeader,this.result.assistant=t,this.resultList.push(this.result),this.result={}}}},b={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"SlotMachine"}},[t._m(0),t._v(" "),i("div",{staticClass:"body"},[i("div",{staticClass:"leader"},[i("span",{staticClass:"title"},[t._v("隊長: "+t._s(t.currentLeader)+" ")]),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:t.disabled,expression:"disabled"}],staticClass:"btn",on:{click:t.nextLeader}},[t._v("下一隊")])]),t._v(" "),i("div",{staticClass:"window"},[i("div",{staticClass:"container"},t._l(t.configs,function(e,n){return i("Gift",{key:n,attrs:{defaultOnShow:t.defaultOnShow,trigger:t.trigger,config:e,leader:t.currentLeader},on:{finished:t.isFinished}})}))]),t._v(" "),i("div",{class:["handler",{active:t.active},{disabled:t.disabled}]},[i("div",{staticClass:"stick2"}),t._v(" "),i("div",{staticClass:"stick"}),t._v(" "),i("div",{staticClass:"ball",on:{click:function(e){!t.disabled&&t.turn()}}})])]),t._v(" "),i("div",{staticClass:"history",on:{click:function(e){t.openResultList=!0}}},[t._v("\n    查看分組結果\n  ")]),t._v(" "),i("div",{class:["resultList",{openResultList:t.openResultList}],on:{click:function(e){if(e.target!==e.currentTarget)return null;t.openResultList=!1}}},[i("div",{staticClass:"resultList-container"},t._l(t.resultList,function(e,n){return i("div",{key:n,staticClass:"result"},[t._v(t._s("隊長: "+e.leader+" 助教: "+e.assistant))])}))])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"badge"},[e("span",[this._v("組隊系統")])])}]};var k=i("VU/8")(_,b,!1,function(t){i("qk1s")},null,null).exports;n.a.use(o.a);var w=new o.a({routes:[{path:"/demo",name:"Demo",component:f},{path:"/",name:"SlotMachine",component:k}]}),R=i("8+8L");n.a.use(R.a),n.a.config.productionTip=!1,new n.a({el:"#app",router:w,components:{App:r},template:"<App/>"})},VjNl:function(t,e){},Zhg0:function(t,e){},qk1s:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.fda592b9cc0b9541a3bf.js.map